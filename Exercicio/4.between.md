# PARTE B — 20 exercícios com `BETWEEN` (datas)

1. **Lançamentos entre 1º jan 2025 e 30 jun 2025 (cuidado com timestamps).**

```sql
SELECT * FROM lancamento
WHERE data_lancamento >= '2025-01-01'::timestamp
  AND data_lancamento <  '2025-07-01'::timestamp;
```

_(evita cortar registros do último dia por causa de horas)_

2. **Lançamentos com vencimento entre hoje e 30 dias à frente.**

```sql
SELECT * FROM lancamento
WHERE data_vencimento BETWEEN now() AND (now() + interval '30 days');
```

3. **Contas incluídas entre duas datas usando `BETWEEN`.**

```sql
SELECT * FROM conta
WHERE data_inclusao BETWEEN '2025-06-01'::timestamp AND '2025-06-30'::timestamp;
```

4. **Clientes cadastrados entre 2019 e 2021 (se houvesse `data_cadastro` — não temos; demonstrativo).**
   _(No teu esquema `cliente` não tem `data_cadastro`. Se adicionar, usar `BETWEEN` similar.)_

5. **Lançamentos ocorridos no último trimestre (exemplo dinâmico).**

```sql
SELECT * FROM lancamento
WHERE data_lancamento BETWEEN date_trunc('quarter', now()) - interval '3 months'
                        AND date_trunc('quarter', now()) - interval '1 second';
```

6. **Lançamentos com data de vencimento entre primeiro e último dia do mês anterior.**

```sql
SELECT * FROM lancamento
WHERE data_vencimento >= date_trunc('month', now() - interval '1 month')
  AND data_vencimento <  date_trunc('month', now());
```

7. **Lançamentos criados (data_lancamento) entre as datas da inclusão de uma conta específica.**

```sql
SELECT * FROM lancamento
WHERE data_lancamento BETWEEN
  (SELECT data_inclusao FROM conta WHERE id = 2)
  AND now();
```

8. **Lançamentos de um cliente entre duas datas específicas.**

```sql
SELECT * FROM lancamento
WHERE id_cliente = 5
  AND data_lancamento BETWEEN '2025-02-01' AND '2025-04-30';
```

9. **Pagamentos (situação = 'PAGO') cujo pagamento ocorreu num intervalo (aqui usamos `data_lancamento` como proxy).**

```sql
SELECT * FROM lancamento
WHERE situacao = 'PAGO'
  AND data_lancamento BETWEEN '2025-07-01' AND '2025-07-31';
```

10. **Contactos cujo cliente foi registrado entre datas — (se `cliente` tivesse `data_cadastro`).**
    _(ajustar se adicionar campo `data_cadastro`)_

11. **Lançamentos com parcelas cujo vencimento ocorra dentro de 7 a 14 dias.**

```sql
SELECT * FROM lancamento
WHERE data_vencimento BETWEEN now() + interval '7 days' AND now() + interval '14 days';
```

12. **Contas incluídas entre dias úteis (por exemplo, segunda a sexta) convertendo timestamps.**
    _(mais complexo: usar `EXTRACT(dow FROM data_inclusao)` para filtrar dias da semana)_

13. **Lançamentos entre 1º e último dia do mês anterior (versão simples):**

```sql
SELECT * FROM lancamento
WHERE data_lancamento >= date_trunc('month', now() - interval '1 month')
  AND data_lancamento <  date_trunc('month', now());
```

14. **Lançamentos cujo `data_lancamento` está entre as datas de inclusão de duas contas (multi-subselect).**

```sql
SELECT * FROM lancamento
WHERE data_lancamento BETWEEN
  (SELECT min(data_inclusao) FROM conta WHERE situacao = 'ATIVO')
  AND
  (SELECT max(data_inclusao) FROM conta WHERE situacao = 'ATIVO');
```

15. **Lançamentos vencidos no mês atual.**

```sql
SELECT * FROM lancamento
WHERE date_trunc('month', data_vencimento) = date_trunc('month', now());
```

16. **Lançamentos com `data_lancamento` entre a primeira e última inclusão de conta de um cliente (hipotético).**

```sql
SELECT * FROM lancamento
WHERE data_lancamento BETWEEN
  (SELECT min(data_inclusao) FROM conta)
  AND (SELECT max(data_inclusao) FROM conta);
```

17. **Lançamentos do último ano (365 dias).**

```sql
SELECT * FROM lancamento
WHERE data_lancamento BETWEEN now() - interval '365 days' AND now();
```

18. **Lançamentos com vencimento nos próximos 90 dias e que ainda estejam PENDENTES.**

```sql
SELECT * FROM lancamento
WHERE situacao = 'PENDENTE'
  AND data_vencimento BETWEEN now() AND now() + interval '90 days';
```

19. **Lançamentos gerados entre as datas de inclusão de duas contas específicas.**

```sql
SELECT * FROM lancamento
WHERE data_lancamento BETWEEN (SELECT data_inclusao FROM conta WHERE id=1)
                          AND (SELECT data_inclusao FROM conta WHERE id=2);
```

20. **Lançamentos cujo `data_lancamento` está entre as datas de vencimento de lançamentos de um cliente (ex.: comparar intervalos).**

```sql
SELECT * FROM lancamento l
WHERE l.data_lancamento BETWEEN
  (SELECT min(data_vencimento) FROM lancamento WHERE id_cliente = l.id_cliente)
  AND
  (SELECT max(data_vencimento) FROM lancamento WHERE id_cliente = l.id_cliente);
```
