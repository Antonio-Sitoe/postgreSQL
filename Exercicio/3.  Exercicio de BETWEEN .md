Perfeito, AntÃ³nio ğŸ‘

Vamos montar um **conjunto completo e avanÃ§ado de exercÃ­cios SQL**, exatamente como vocÃª pediu â€” com **IN + JOIN**, **BETWEEN com datas**, e **consultas estatÃ­sticas complexas** â€” todos realistas, baseados em um modelo de banco de dados empresarial completo.

---

## ğŸ§© MODELO DE BANCO DE DADOS BASE (contexto)

Essas tabelas sÃ£o as que vamos usar nos exercÃ­cios:

### **Tabelas principais**

| Tabela         | DescriÃ§Ã£o                   | Campos principais                                               |
| -------------- | --------------------------- | --------------------------------------------------------------- |
| `cliente`      | Clientes da empresa         | `id`, `nome_empresarial`, `pais`, `data_cadastro`               |
| `pedido`       | Pedidos feitos por clientes | `id`, `id_cliente`, `data_pedido`, `valor_total`, `status`      |
| `item_pedido`  | Itens dos pedidos           | `id_pedido`, `id_produto`, `quantidade`, `preco_unitario`       |
| `produto`      | Produtos vendidos           | `id`, `nome_produto`, `categoria`, `preco_unitario`, `ativo`    |
| `fornecedor`   | Fornecedores de produtos    | `id`, `nome_fornecedor`, `pais`, `ativo`                        |
| `pagamento`    | Pagamentos de pedidos       | `id_pedido`, `data_pagamento`, `valor_pago`, `metodo_pagamento` |
| `funcionario`  | FuncionÃ¡rios da empresa     | `id`, `nome`, `departamento`, `salario`, `data_contratacao`     |
| `departamento` | Departamentos internos      | `id`, `nome_departamento`, `orcamento_anual`                    |

---

# ğŸ§  PARTE 1 â€” 30 ExercÃ­cios AvanÃ§ados com **`IN`** + `JOIN`

Esses exercÃ­cios incluem **subconsultas dentro do `IN`**, algumas com **3 ou mais nÃ­veis de SELECT**.

### ğŸ”¹ ExercÃ­cios 1â€“10 (BÃ¡sico â†’ IntermediÃ¡rio)

1. Liste todos os clientes cujo **id** aparece na tabela `pedido` (clientes que jÃ¡ fizeram pedidos).

   ```sql
   SELECT id, nome_empresarial
   FROM cliente
   WHERE id IN (SELECT id_cliente FROM pedido);
   ```

2. Liste todos os pedidos feitos por clientes **do Brasil**.

   ```sql
   SELECT p.id, p.data_pedido, p.valor_total
   FROM pedido p
   WHERE p.id_cliente IN (
       SELECT c.id FROM cliente c WHERE c.pais = 'Brasil'
   );
   ```

3. Liste produtos que **jÃ¡ foram vendidos** (existem em `item_pedido`).

   ```sql
   SELECT id, nome_produto
   FROM produto
   WHERE id IN (SELECT id_produto FROM item_pedido);
   ```

4. Liste fornecedores cujos produtos **foram incluÃ­dos em algum pedido**.

   ```sql
   SELECT f.id, f.nome_fornecedor
   FROM fornecedor f
   WHERE f.id IN (
       SELECT p.id_fornecedor
       FROM produto p
       WHERE p.id IN (SELECT id_produto FROM item_pedido)
   );
   ```

5. Liste clientes que **fizeram pedidos pagos**.

   ```sql
   SELECT nome_empresarial
   FROM cliente
   WHERE id IN (
       SELECT id_cliente
       FROM pedido
       WHERE id IN (SELECT id_pedido FROM pagamento)
   );
   ```

6. Liste produtos vendidos **por fornecedores brasileiros**.

   ```sql
   SELECT nome_produto
   FROM produto
   WHERE id IN (
       SELECT ip.id_produto
       FROM item_pedido ip
       WHERE ip.id_pedido IN (
           SELECT p.id
           FROM pedido p
           WHERE p.id_cliente IN (
               SELECT c.id FROM cliente c WHERE c.pais = 'Brasil'
           )
       )
   );
   ```

7. Mostre clientes que **nunca fizeram pedidos** (usando `NOT IN`).

   ```sql
   SELECT id, nome_empresarial
   FROM cliente
   WHERE id NOT IN (SELECT id_cliente FROM pedido);
   ```

8. Liste pedidos de produtos **inativos**, se existirem.

   ```sql
   SELECT DISTINCT p.id, p.data_pedido
   FROM pedido p
   JOIN item_pedido i ON p.id = i.id_pedido
   WHERE i.id_produto IN (SELECT id FROM produto WHERE ativo = FALSE);
   ```

9. Liste funcionÃ¡rios que trabalham em departamentos cujo orÃ§amento estÃ¡ **entre os 10 maiores**.

   ```sql
   SELECT nome
   FROM funcionario
   WHERE departamento IN (
       SELECT nome_departamento
       FROM departamento
       ORDER BY orcamento_anual DESC
       LIMIT 10
   );
   ```

10. Mostre produtos que **foram vendidos em pedidos com valor_total > 10000**.

    ```sql
    SELECT DISTINCT pr.nome_produto
    FROM produto pr
    WHERE pr.id IN (
        SELECT i.id_produto
        FROM item_pedido i
        WHERE i.id_pedido IN (
            SELECT id FROM pedido WHERE valor_total > 10000
        )
    );
    ```

---

### ğŸ”¹ ExercÃ­cios 11â€“20 (AvanÃ§ado â€” com mÃºltiplos `JOIN` e subconsultas aninhadas)

11. Liste clientes com pedidos pagos **via cartÃ£o**.
12. Liste produtos vendidos **em mais de 3 paÃ­ses diferentes**.
13. Liste fornecedores que fornecem produtos **com preÃ§o acima da mÃ©dia geral**.
14. Liste funcionÃ¡rios cujo departamento tem **mais de 5 funcionÃ¡rios**.
15. Liste clientes que **compraram produtos de fornecedores europeus**.
16. Liste pedidos que **ainda nÃ£o possuem pagamento registrado**.
17. Liste produtos que **nunca foram vendidos** (usando `NOT IN` com subselects).
18. Liste departamentos com funcionÃ¡rios que **ganham acima da mÃ©dia do departamento**.
19. Liste clientes que compraram produtos de uma categoria especÃ­fica (ex: "EletrÃ´nicos").
20. Liste produtos fornecidos por fornecedores **que tambÃ©m sÃ£o clientes da empresa** (caso de parceria cruzada).

_(posso expandir cada uma dessas com SQL completo se desejar)_

---

### ğŸ”¹ ExercÃ­cios 21â€“30 (Muito AvanÃ§ado â€” mÃºltiplos SELECTs dentro de `IN`)

21. Clientes que compraram produtos **fornecidos por fornecedores de paÃ­ses iguais aos deles**.
22. Produtos que foram vendidos **em pedidos pagos em mais de um mÃ©todo** (ex: parte cartÃ£o, parte dinheiro).
23. FuncionÃ¡rios que trabalham em departamentos **que tÃªm orÃ§amentos maiores que a soma dos salÃ¡rios de seus membros**.
24. Pedidos que contÃªm **apenas produtos ativos**.
25. Clientes com pedidos cujo **valor mÃ©dio por produto > 1000**.
26. Produtos que **foram vendidos mais de uma vez no mesmo pedido**.
27. Clientes que compraram **exatamente os mesmos produtos** que outro cliente especÃ­fico.
28. Pedidos feitos por clientes **que tambÃ©m sÃ£o fornecedores**.
29. Produtos com preÃ§o **acima da mÃ©dia dos produtos de mesmo fornecedor**.
30. Clientes com **mais de 3 pedidos nÃ£o pagos**.

---

# ğŸ“† PARTE 2 â€” 20 ExercÃ­cios com **`BETWEEN`** (Datas e Valores)

1. Pedidos entre `'2025-01-01'` e `'2025-06-30'`.
2. Clientes cadastrados entre 2020 e 2022.
3. Pagamentos realizados entre duas datas especÃ­ficas.
4. FuncionÃ¡rios contratados entre 2010 e 2015.
5. Produtos com preÃ§o entre 100 e 500.
6. Departamentos com orÃ§amento entre 1M e 5M.
7. Pedidos com valor_total entre 5000 e 20000.
8. Clientes cujo nome comeÃ§a com Aâ€“M (usando ASCII + BETWEEN).
9. Pagamentos feitos entre 10h e 18h.
10. Pedidos feitos entre segunda e sexta (extraindo dia da semana).
11. Produtos cadastrados entre duas datas.
12. FuncionÃ¡rios com tempo de casa entre 3 e 10 anos.
13. Pedidos entregues entre 3 e 7 dias apÃ³s a data do pedido.
14. Clientes com idade (data_nascimento) entre 25 e 35 anos.
15. Pedidos entre o 1Âº e o Ãºltimo dia do mÃªs anterior.
16. Pagamentos feitos entre o primeiro e o Ãºltimo pagamento do cliente.
17. Departamentos com orÃ§amento entre 80% e 120% da mÃ©dia geral.
18. Produtos com preÃ§o dentro do intervalo interquartil (Q1 e Q3).
19. Pedidos com data_pedido entre as datas do 1Âº e do Ãºltimo pedido do cliente.
20. FuncionÃ¡rios contratados **entre as datas de contrataÃ§Ã£o de dois gerentes especÃ­ficos**.

_(tambÃ©m posso montar as queries completas com funÃ§Ãµes de data se quiser)_

---

# ğŸ“Š PARTE 3 â€” 10 ExercÃ­cios AvanÃ§ados de **EstatÃ­sticas**

1. Valor mÃ©dio de pedidos por cliente.
2. Desvio padrÃ£o do valor_total dos pedidos.
3. Total de pedidos por mÃªs (usando `GROUP BY DATE_TRUNC('month', data_pedido)`).
4. Faturamento total por categoria de produto.
5. Percentual de pedidos pagos x nÃ£o pagos.
6. SalÃ¡rio mÃ©dio por departamento.
7. Top 5 produtos mais vendidos.
8. Lucro estimado por fornecedor (preÃ§o Ã— quantidade â€“ custo).
9. Crescimento percentual mensal de vendas.
10. Clientes que representam os 20% responsÃ¡veis por 80% das vendas (anÃ¡lise Pareto).

---

Se quiser, posso agora:

- âœ… gerar **as 30 queries completas da parte 1** com explicaÃ§Ã£o linha a linha,
- ou gerar **os 20 exercÃ­cios de BETWEEN** com funÃ§Ãµes reais de data (`CURRENT_DATE`, `EXTRACT`, etc),
- ou ainda **as 10 estatÃ­sticas completas com SQL pronto para PostgreSQL**.

ğŸ‘‰ Qual parte vocÃª quer que eu desenvolva **primeiro em cÃ³digo SQL completo e comentado**?
